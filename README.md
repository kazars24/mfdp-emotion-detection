# Распознавание эмоций в маркетинговых исследованиях
## О проекте
Данный репозиторий подготовлен в рамках курса My First Data Project 2 от [AI Talent Hub](https://ai.itmo.ru/course), который подразумевает разработку реального сервиса, полезного для бизнеса, с применением машинного обучения.
С этапами развития проекта можно ознакомиться в папке [course modules](https://github.com/kazars24/mfdp-emotion-detection/tree/main/course%20modules).
## Описание проекта
Распознавание эмоций в маркетинговых исследованиях, или так называемый эмоциональный маркетинг, в последние годы только набирает обороты. Маркетологи пришли к выводу, что «эмоциональная» коммуникация с аудиторией повышает эффективность рекламной кампании, ведь потребители, выбирая тот или иной продукт, руководствуются своим восприятием вещи, ощущением от нее, сам же продукт как бы отходит на второй план. Именно поэтому в продвижении товара центральное место должна занимать эмоция, ассоциирующаяся с ним.

Эмоции – это то, что заставляет аудиторию покупать. Исследования, проведенные нейробиологом Антонио Дамасио, обнаружили, что люди с повреждением части мозга, вызывающей эмоции (другими словами, люди, которые не могут чувствовать эмоции), находят принятие решений чрезвычайно трудным занятием.

Ссылка на исследование: https://academic.oup.com/cercor/article/10/3/295/449599

**Для кого**: для маркетологов, проводящих тестовые показы рекламных материалов с целью получения обратной связи.

**Которые**: хотят добавить эмоциональную оценку пользователей в свои исследования, но не способны достаточно точно определить их эмоции и не хотят делать это вручную. 

**Решение**: необходимо разработать продукт, который будет способен при показе рекламных материалов по видео определить человеческие эмоции.

**Ценность**: данное решение должно помочь маркетологам проводить эмоциональную оценку рекламы с высокой точностью; выдавать отчет о том, какие эмоции были в определенный момент; автоматизировать и ускорить процесс определения эмоций, если таковой уже используется.
**Эмоции**: гнев, отвращение, страх, счастье, грусть, удивление и нейтральное. Они объединяются в 3 основные группы: позитив (счастье, удивление), негатив (гнев, отвращение, страх, грусть), нейтральное.

Более подробно о проекте, метриках и данных можно ознакомиться в разделе [course modules/2.Formulating the problem in terms of ML](https://github.com/kazars24/mfdp-emotion-detection/tree/main/course%20modules/2.Formulating%20the%20problem%20in%20terms%20of%20ML)

## Выбор моделей
Используемый пайплайн состоит из двух частей: детекция лиц на изображении и классификация эмоций. В ходе экспериментов были выбраны наиболее оптимальные модели для данных задач.
### Детекция лиц
Для нахождения лиц на кадрах была выбрана модель YOLOv8n поскольку она показала лучние результаты среди прочих. Ее значения метрик:
* Ср. IoU: 0.9;
* Ср. время: 0.03;
* Не найдено лиц: 0.03%.

### Классификация эмоций
Тут выбор пал на InceptionResnetV1, предобученную на casia-webface, с файнтюнингом на RAF Face Database. Метрики:
* Loss = 0.5098;
* FPS = 1609.1836;
* Accuracy = 0.8576.

Для данной модели была построена матрица ошибок с целью изучения того, в каких эмоциях модель путается, а какие определяет уверенно.

![confusion_matrix](https://github.com/kazars24/mfdp-emotion-detection/blob/main/course%20modules/4.Improving%20models/confusion_matrix.png)

Как можно заметить, в целом модель справляется хорошо. А больше всего она путает классы happy и neutral, neutral и sad.

Более подробно с результатами экспериментов можно ознакомиться в разделе [course modules/4.Improving models](https://github.com/kazars24/mfdp-emotion-detection/tree/main/course%20modules/4.Improving%20models)

## Инструкция по запуску сервиса
### Шаг 1
Склонируйте репозиторий командой:
```
git clone https://github.com/kazars24/mfdp-emotion-detection.git
```
И перейдите в папку mfdp-emotion-detection:
```
cd mfdp-emotion-detection
```
### Шаг 2
Для успешного использования сервиса вам необходимо установить себе на компьютер [Docker](https://www.docker.com/).
После чего выполнить следующую команду:
```
docker build -t mfdp .
```
### Шаг 3
И наконец, для запуска приложения нужно выполнить команду:
```
docker run -p 8502:8502 mfdp
```
После чего к сервису можно перейти по одному их этих хостов:
* URL: http://localhost:8502

### Шаг 4
Перейдя на сайт, следуйте инструкциям на экране или ознакомьтесь с ними тут.
Последовательность действий:
1. Включите камеру, нажав на красную кнопку START
2. Запустите видео
3. Запустите анализ эмоций, нажав кнопку ANALYZE EMOTION

## Техническая документация
[Техническая документация](https://github.com/kazars24/mfdp-emotion-detection/blob/main/course%20modules/5.%20Packaging%20the%20service/techdocs.md)
